<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁúãË≠∑„Çµ„Éû„É™„Éº‰ΩúÊàê„Ç¢„Éó„É™</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- PDFÁîüÊàê„É©„Ç§„Éñ„É©„É™„ÇíËøΩÂä† -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap');
        
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #555; margin: 0; padding: 20px; }
        
        /* Â∏≥Á•®„Çπ„Çø„Ç§„É´ (A4) */
        /* --- FIX START --- */
        .sheet {
            width: 210mm; height: 297mm; background: white; padding: 8mm 10mm;
            box-shadow: 0 0 10px rgba(0,0,0,0.5); margin: 0 auto; color: black;
            font-size: 10pt; line-height: 1.3; box-sizing: border-box;
            display: flex; flex-direction: column; overflow: hidden;
        }
        /* --- FIX END --- */

        /* ExcelÈ¢®„ÉÜ„Éº„Éñ„É´ */
        table.excel {
            width: 100%; border-collapse: collapse; border: 2px solid #000;
            font-size: 9.5pt; table-layout: fixed; margin-bottom: 4px;
        }
        table.excel th, table.excel td {
            border: 1px solid #000; padding: 2px 4px; vertical-align: middle;
            word-wrap: break-word;
        }
        /* --- FIX START --- */
        table.excel tr {
            height: 1px; /* Âç∞Âà∑ÊôÇ„ÅÆÂêÑË°å„ÅÆÊúÄÂ∞èÈ´ò„Åï„ÇíÁ∂≠ÊåÅ„Åó„ÄÅ‰∏çË¶Å„Å™Á∏¶‰º∏„Å≥„ÇíÈò≤Ê≠¢„Åô„Çã */
        }
        /* --- FIX END --- */
        table.excel th { text-align: center; background-color: #f0f0f0; font-weight: normal; }

        /* „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£ */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-xs { font-size: 8pt; }
        .font-bold { font-weight: bold; }
        .text-red { color: #cc0000; }
        .border-none { border: none !important; }
        .border-b { border-bottom: 1px solid #000; }
        .border-r { border-right: 1px solid #000; }
        .border-l { border-left: 1px solid #000; }
        .border-r-0 { border-right: none !important; }
        .border-l-0 { border-left: none !important; }
        .align-top { vertical-align: top !important; }
        .p-0 { padding: 0 !important; }
        .pl-8 { padding-left: 2rem !important; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-gray-200 { background-color: #e5e7eb; }
        .whitespace-nowrap { white-space: nowrap; }
        .overflow-hidden { overflow: hidden; }
        .text-ellipsis { text-overflow: ellipsis; }
        .tracking-tighter { letter-spacing: -0.05em; }
        
        /* „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„ÇπË°®Áèæ */
        .cb { display: inline-block; width: 11px; height: 11px; border: 1px solid #000; margin-right: 2px; position: relative; top: 1px; background: white;}
        .cb.on::after { content: '‚úî'; position: absolute; top: -6px; left: -1px; font-size: 14px; font-weight: bold; color: black; }

        /* Âç∞Âà∑Ë®≠ÂÆö */
        /* --- FIX START --- */
        @media print {
            body { background: white; padding: 0; margin: 0; -webkit-print-color-adjust: exact; }
            .no-print { display: none !important; }
            .sheet { 
                width: 210mm; 
                height: 297mm; 
                box-shadow: none; 
                padding: 10mm 12mm; 
                margin: 0 auto; 
                border: none;
                display: flex;
                flex-direction: column;
            }
            @page { size: A4 portrait; margin: 0; }
        }
        /* --- FIX END --- */
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£
        const toWareki = (dateStr) => {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            if (isNaN(date.getTime())) return dateStr;
            return date.toLocaleDateString('ja-JP-u-ca-japanese', { year: 'numeric', month: 'long', day: 'numeric' });
        };

        const calculateAge = (dateStr) => {
            if (!dateStr) return '';
            const birthDate = new Date(dateStr);
            const today = new Date();
            if (isNaN(birthDate.getTime())) return '';
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) age--;
            return age.toString();
        };

        const warekiToDateStr = (era, year, month, day) => {
            if (!era || !year || !month || !day) return '';
            let seirekiYear = parseInt(year);
            if (era === 'Êò≠Âíå') seirekiYear += 1925;
            else if (era === 'Âπ≥Êàê') seirekiYear += 1988;
            else if (era === '‰ª§Âíå') seirekiYear += 2018;
            else if (era === 'ÊòéÊ≤ª') seirekiYear += 1867;
            else if (era === 'Â§ßÊ≠£') seirekiYear += 1911;
            return `${seirekiYear}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
        };

        // ÂàùÊúü„Éá„Éº„Çø („Åô„Åπ„Å¶Á©∫„Å´„Åô„Çã)
        const initialData = {
            createEra: '‰ª§Âíå', createYear: '8', createMonth: '2', createDay: '20',
            facilityName: 'Á§æ‰ºöÁ¶èÁ•âÊ≥ï‰∫∫ ËÅñ„Éï„É©„É≥„Ç∑„Çπ„Ç≥‰ºö\nÁâπÂà•È§äË≠∑ËÄÅ‰∫∫„Éõ„Éº„É† „Ç´„Çµ„Éá„Éû„Éâ„É¨',
            staffName: '',
            
            name: '', kana: '', gender: 'Áî∑',
            birthEra: 'Êò≠Âíå', birthYear: '', birthMonth: '', birthDay: '',
            birthDate: '', age: '',
            height: '', weight: '', measureDate: '',
            careLevel: '', careManager: '',
            admissionDate: '', doctor: '',
            address: '', tel: '',

            kp1_name: '', kp1_rel: '', kp1_tel: '',
            kp2_name: '', kp2_rel: '', kp2_tel: '',

            pastIllness: '',
            familyStructure: '', 
            
            infection: '', infectionDetail: '',
            allergy: '', allergyDetail: '',

            bp_sys: '', bp_dia: '', pulse: '', temp: '',
            vaccine_flu: '', vaccine_corona: '', vaccine_corona_count: '',
            
            historyInfo: '',

            move_status: { walk: false, cane: false, car: false, walker: false, wheelchair: false, reclining: false },
            move_note: '', 

            food_level: '', food_main: '', food_side: '', food_toromi: '',
            food_note: '', 

            exc_level: '', exc_tool: { toilet: false, portable: false, rehab_pants: false, diaper: false },
            exc_urine_freq: '', exc_stool_freq: '', exc_last_stool_month: '', exc_last_stool_day: '',
            exc_urine_sense: '', exc_stool_sense: '', exc_laxative: '', exc_laxative_detail: '',
            exc_note: '', 

            bath_level: '', bath_freq: '', bath_method: '', bath_last_month: '', bath_last_day: '',
            bath_note: '', 

            cloth_level: '', cloth_note: '', 

            sleep_status: '', sleep_drug: '', sleep_drug_detail: '',
            sleep_note: '', 

            treatment_detail: '',

            disability: { sight: false, hearing: false, speech: false, cognitive: false, motor: false, other: false },
            communication: '', glasses: '', hearing_aid: '', denture: '', denture_detail: '',
            specialNote: ''
        };

        const eras = ['Êò≠Âíå', 'Â§ßÊ≠£', 'ÊòéÊ≤ª', 'Âπ≥Êàê', '‰ª§Âíå'];
        const genders = ['Áî∑', 'Â•≥'];
        const careLevels = ['Ë¶ÅÊîØÊè¥1','Ë¶ÅÊîØÊè¥2','Ë¶Å‰ªãË≠∑1','Ë¶Å‰ªãË≠∑2','Ë¶Å‰ªãË≠∑3','Ë¶Å‰ªãË≠∑4','Ë¶Å‰ªãË≠∑5'];
        const majorDiseases = ['È´òË°ÄÂúßÁóá', 'ËÑ≥Ê¢óÂ°û', 'ËÑ≥Âá∫Ë°Ä', '„Ç¢„É´„ÉÑ„Éè„Ç§„Éû„ÉºÂûãË™çÁü•Áóá', '„É¨„Éì„ÉºÂ∞è‰ΩìÂûãË™çÁü•Áóá', 'ÂøÉ‰∏çÂÖ®', 'Ë™§Âö•ÊÄßËÇ∫ÁÇé', 'Á≥ñÂ∞øÁóÖ', 'È™®Á≤óÈ¨ÜÁóá'];
        const infectionList = ['Ôº®Ôº¢ÊäóÂéü', 'Ôº®Ôº£Ôº∂', 'Ôº¥Ôº∞Ê¢ÖÊØí', 'Ôº≠Ôº≤Ôº≥Ôº°'];
        const stapleFoodOptions = ['Á±≥È£Ø', 'ËªüÈ£Ø', 'ÂÖ®Á≤•', '„Éü„Ç≠„Çµ„ÉºÁ≤•', '„Çº„É™„ÉºÁ≤•', '„Éë„É≥', 'È∫∫È°û'];
        const sideDishOptions = ['Â∏∏Ëèú', '‰∏ÄÂè£Â§ß', 'Á≤óÂàª„Åø', 'Âàª„Åø', 'Ê•µÂàª„Åø', '„Éö„Éº„Çπ„Éà', '„ÇΩ„Éï„ÉàÈ£ü'];
        const toromiOptions = ['„Å™„Åó', 'Êúâ (Âº∑)', 'Êúâ (‰∏≠Èñì)', 'Êúâ (ËñÑ„ÅÑ)'];

        // UI„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà (ÂÄ§„ÇíÁõ¥Êé•Ëøî„Åô„Çà„ÅÜ„Å´Áµ±‰∏Ä)
        const InputGroup = ({ title, children }) => (
            <div className="bg-gray-800 p-3 rounded mb-4 border border-gray-600">
                <h3 className="text-sm font-bold text-green-400 mb-2 border-b border-gray-600 pb-1">{title}</h3>
                {children}
            </div>
        );
        const Label = ({ children }) => <label className="block text-xs text-gray-400 mb-1">{children}</label>;
        const Input = ({ value, onChange, placeholder, type="text", className="", ...props }) => (
            <input 
                type={type} 
                value={value || ''} 
                onChange={e => onChange(e.target.value)} 
                placeholder={placeholder} 
                className={`bg-gray-900 border border-gray-600 rounded px-2 py-1 text-sm text-white focus:border-blue-500 focus:outline-none ${className}`} 
                {...props}
            />
        );
        const TextArea = ({ value, onChange, placeholder, rows=2, className="", ...props }) => (
            <textarea 
                value={value || ''} 
                onChange={e => onChange(e.target.value)} 
                placeholder={placeholder} 
                rows={rows} 
                className={`w-full bg-gray-900 border border-gray-600 rounded px-2 py-1 text-sm text-white focus:border-blue-500 focus:outline-none ${className}`} 
                {...props}
            />
        );
        const Select = ({ value, onChange, options, className="" }) => (
            <select 
                value={value || ''} 
                onChange={e => onChange(e.target.value)} 
                className={`bg-gray-900 border border-gray-600 rounded px-2 py-1 text-sm text-white focus:border-blue-500 focus:outline-none ${className}`} 
            >
                <option value="">ÈÅ∏Êäû</option>
                {options.map(opt => <option key={opt} value={opt}>{opt}</option>)}
            </select>
        );
        const CheckBox = ({ label, checked, onChange }) => (
            <label className="flex items-center cursor-pointer mr-3 mb-1">
                <input 
                    type="checkbox" 
                    checked={!!checked} 
                    onChange={e => onChange(e.target.checked)} 
                    className="mr-1" 
                />
                <span className="text-sm text-gray-200">{label}</span>
            </label>
        );
        const RadioGroup = ({ options, value, onChange }) => (
            <div className="flex flex-wrap gap-2">
                {options.map(opt => (
                    <label key={opt} className="flex items-center cursor-pointer">
                        <input 
                            type="radio" 
                            checked={value === opt} 
                            onChange={() => onChange(opt)} 
                            className="mr-1" 
                        />
                        <span className="text-sm text-gray-200">{opt}</span>
                    </label>
                ))}
            </div>
        );

        function App() {
            const [data, setData] = useState(() => {
                try {
                    const saved = localStorage.getItem('summaryDataFinal_v4');
                    return saved ? JSON.parse(saved) : initialData;
                } catch { return initialData; }
            });
            const [historyYear, setHistoryYear] = useState('');

            useEffect(() => { localStorage.setItem('summaryDataFinal_v4', JSON.stringify(data)); }, [data]);

            const up = (key, val) => setData(p => ({ ...p, [key]: val }));
            const upDeep = (pKey, key, val) => setData(p => ({ ...p, [pKey]: { ...p[pKey], [key]: val } }));

            const handleBirthChange = (key, val) => {
                setData(prev => {
                    const next = { ...prev, [key]: val };
                    const dateStr = warekiToDateStr(next.birthEra, next.birthYear, next.birthMonth, next.birthDay);
                    const age = calculateAge(dateStr);
                    return { ...next, birthDate: dateStr, age };
                });
            };

            const addDisease = (disease) => {
                if(!disease) return;
                const entry = historyYear ? `${disease} (${historyYear})` : disease;
                setData(p => ({ ...p, pastIllness: p.pastIllness ? p.pastIllness + '\n' + entry : entry }));
            };

            const getCheckedItems = (obj, labels) => {
                return Object.keys(obj)
                    .filter(key => obj[key])
                    .map(key => labels[key] || key)
                    .join('„ÄÅ');
            };

            const moveLabels = { walk: 'Áã¨Ê≠©', cane: 'Êùñ', car: 'ËÄÅ‰∫∫Ëªä', walker: 'Ê≠©Ë°åÂô®', wheelchair: 'ËªäÊ§ÖÂ≠ê', reclining: '„É™„ÇØ„É©„Ç§„Éã„É≥„Ç∞' };
            const excLabels = { toilet: '„Éà„Ç§„É¨', portable: '„Éù„Éº„Çø„Éñ„É´', rehab_pants: '„É™„Éè„Éë„É≥', diaper: '„Ç™„É†„ÉÑ' };
            const disLabels = { sight: 'Ë¶ñË¶ö', hearing: 'ËÅ¥Ë¶ö', speech: 'Ë®ÄË™û', cognitive: 'Ë™çÁü•', motor: 'ÈÅãÂãï', other: '„Åù„ÅÆ‰ªñ' };

            // --- PDF„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÂá¶ÁêÜ ---
            const handleExportPdf = () => {
                const element = document.getElementById('print-area');
                if (!element) return;

                // html2pdf„ÅÆË®≠ÂÆö„Ç™„Éó„Ç∑„Éß„É≥
                const opt = {
                    margin: 0, // ‰ΩôÁôΩ„Å™„ÅóÔºàCSSÂÅ¥„ÅÆpadding„Çí‰ΩøÁî®Ôºâ
                    filename: `ÁúãË≠∑„Çµ„Éû„É™„Éº_${data.name || 'Êñ∞Ë¶è'}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2, 
                        useCORS: true, 
                        letterRendering: true,
                        logging: false 
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait' 
                    }
                };

                // „É©„Ç§„Éñ„É©„É™„Çí‰ΩøÁî®„Åó„Å¶PDFÁîüÊàê„ÇíÂÆüË°å
                if (window.html2pdf) {
                    window.html2pdf().set(opt).from(element).save();
                } else {
                    console.error('html2pdf library is not loaded');
                }
            };

            // „Éá„Éº„Çø‰øùÂ≠òÔºàJSON„Éï„Ç°„Ç§„É´Êõ∏„ÅçÂá∫„ÅóÔºâ
            const handleSaveFile = () => {
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ÁúãË≠∑„Çµ„Éû„É™„Éº_${data.name || '„Éá„Éº„Çø'}.json`;
                a.click();
                URL.revokeObjectURL(url);
            };

            // „Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÔºàJSON„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„ÅøÔºâ
            const handleLoadFile = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const json = JSON.parse(event.target.result);
                        setData(json);
                    } catch (err) {
                        console.error('Failed to load JSON:', err);
                    }
                };
                reader.readAsText(file);
                e.target.value = ''; // ÈÄ£Á∂öË™≠„ÅøËæº„Åø„ÇíÂèØËÉΩ„Å´„Åô„Çã„Åü„ÇÅ„É™„Çª„ÉÉ„Éà
            };

            return (
                <div className="flex flex-col md:flex-row min-h-screen">
                    {/* Â∑¶ÂÅ¥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„É† */}
                    <div className="w-full md:w-1/3 bg-gray-900 text-white p-4 overflow-y-auto h-screen no-print box-border">
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-xl font-bold text-green-400">Ë©≥Á¥∞„Çµ„Éû„É™„ÉºÂÖ•Âäõ</h2>
                            <div className="flex gap-2">
                                <button onClick={() => {if(window.confirm('ÂÖ®„Å¶„ÅÆÂÖ•Âäõ„ÇíÊ∂àÂéª„Åó„Åæ„Åô„ÅãÔºü')){setData(initialData)}}} className="bg-red-600 px-3 py-1 rounded text-sm hover:bg-red-500">„ÇØ„É™„Ç¢</button>
                                
                                <button onClick={handleSaveFile} className="bg-blue-600 px-3 py-1 rounded text-sm hover:bg-blue-500">‰øùÂ≠ò</button>
                                <button onClick={() => document.getElementById('file-input').click()} className="bg-gray-600 px-3 py-1 rounded text-sm hover:bg-gray-500">Ë™≠Ëæº</button>
                                <input id="file-input" type="file" accept=".json" onChange={handleLoadFile} className="hidden" />

                                <button onClick={handleExportPdf} className="bg-orange-600 px-3 py-1 rounded text-sm font-bold hover:bg-orange-500 text-white shadow">PDF‰øùÂ≠ò</button>
                            </div>
                        </div>

                        <InputGroup title="1. Âü∫Êú¨ÊÉÖÂ†±">
                        <Label>‰ΩúÊàêÊó•</Label>
                            <div className="relative bg-gray-700 rounded border border-gray-600">
                                        <input type="date" value={data.admissionDate} onChange={e=>up('admissionDate',e.target.value)} className="w-full bg-transparent text-white px-2 py-1 outline-none cursor-pointer" style={{colorScheme:"dark"}}/>
                                        <span className="absolute right-2 top-1 pointer-events-none">üìÖ</span>
                                    </div>
                            <div className="grid grid-cols-2 gap-2 mb-2">
                                <div><Label>„Éï„É™„Ç¨„Éä</Label><Input value={data.kana} onChange={v=>up('kana',v)} /></div>
                                <div><Label>Ê∞èÂêç</Label><Input value={data.name} onChange={v=>up('name',v)} /></div>
                            </div>
                            
                            <div className="mb-2">
                                <Label>ÊÄßÂà•</Label>
                                <Select value={data.gender} onChange={v=>up('gender',v)} options={genders} className="w-1/2"/>
                            </div>
                            
                            <Label>ÁîüÂπ¥ÊúàÊó• (ÂíåÊö¶ÂÖ•Âäõ) + Âπ¥ÈΩ¢</Label>
                            <div className="flex gap-1 mb-4 items-center">
                                <Select value={data.birthEra} onChange={v=>handleBirthChange('birthEra',v)} options={eras} className="w-20"/>
                                <Input value={data.birthYear} onChange={v=>handleBirthChange('birthYear',v)} className="w-12 text-center" placeholder="Âπ¥"/>
                                <Input value={data.birthMonth} onChange={v=>handleBirthChange('birthMonth',v)} className="w-10 text-center" placeholder="Êúà"/>
                                <Input value={data.birthDay} onChange={v=>handleBirthChange('birthDay',v)} className="w-10 text-center" placeholder="Êó•"/>
                                <div className="text-yellow-400 font-bold ml-1">{data.age}Ê≠≥</div>
                            </div>

                            <div className="mb-2 w-full"> <Label>‰ΩèÊâÄ</Label> <Input className="w-full" value={data.address} onChange={v => up('address', v)} /></div>
                            <div className="mb-4"><Label>ÈõªË©±Áï™Âè∑</Label><Input value={data.tel} onChange={v=>up('tel',v)} /></div>
                            
                            <div className="grid grid-cols-2 gap-2 mb-4">
                                <div>
                                    <Label>ÂÖ•ÊâÄÊó• („Ç´„É¨„É≥„ÉÄ„Éº)</Label>
                                    <div className="relative bg-gray-700 rounded border border-gray-600">
                                        <input type="date" value={data.createdDate} onChange={e=>up('createdDate',e.target.value)} className="w-full bg-transparent text-white px-2 py-1 outline-none cursor-pointer" style={{colorScheme:"dark"}}/>
                                        <span className="absolute right-2 top-1 pointer-events-none">üìÖ</span>
                                    </div>
                                </div>
                                <div><Label>‰∏ªÊ≤ªÂåª</Label><Input value={data.doctor} onChange={v=>up('doctor',v)} /></div>
                            </div>

                            <div className="grid grid-cols-2 gap-2 mb-2">
                                <div><Label>‰ªãË≠∑Â∫¶</Label><Select value={data.careLevel} onChange={v=>up('careLevel',v)} options={careLevels} /></div>
                                <div><Label>„Ç±„Ç¢„Éû„Éç</Label><Input value={data.careManager} onChange={v=>up('careManager',v)} placeholder="ÊãÖÂΩì„Ç±„Ç¢„Éû„Éç"/></div>
                            </div>
                        </InputGroup>

                        <InputGroup title="2. „Ç≠„Éº„Éë„Éº„ÇΩ„É≥">
                            <div className="grid grid-cols-3 gap-1 mb-2">
                                <div className="col-span-1"><Label>ÈÄ£Áµ°ÂÖà‚ë† Ê∞èÂêç</Label><Input value={data.kp1_name} onChange={v=>up('kp1_name',v)} /></div>
                                <div className="col-span-1"><Label>Á∂öÊüÑ</Label><Input value={data.kp1_rel} onChange={v=>up('kp1_rel',v)} /></div>
                                <div className="col-span-1"><Label>TEL</Label><Input value={data.kp1_tel} onChange={v=>up('kp1_tel',v)} /></div>
                            </div>
                            <div className="grid grid-cols-3 gap-1">
                                <div className="col-span-1"><Label>ÈÄ£Áµ°ÂÖà‚ë° Ê∞èÂêç</Label><Input value={data.kp2_name} onChange={v=>up('kp2_name',v)} /></div>
                                <div className="col-span-1"><Label>Á∂öÊüÑ</Label><Input value={data.kp2_rel} onChange={v=>up('kp2_rel',v)} /></div>
                                <div className="col-span-1"><Label>TEL</Label><Input value={data.kp2_tel} onChange={v=>up('kp2_tel',v)} /></div>
                            </div>
                        </InputGroup>

                        <InputGroup title="3. ÂåªÁôÇÊÉÖÂ†±">
                            <Label>Êó¢ÂæÄÊ≠¥ (Âπ¥ + ÈÅ∏Êäû)</Label>
                            <div className="flex gap-2 mb-2">
                                <Input value={historyYear} onChange={val => setHistoryYear(val)} placeholder="Âπ¥(R2)" className="w-1/3"/>
                                <select onChange={e=>{addDisease(e.target.value); e.target.value=''}} className="w-2/3 bg-gray-900 border border-gray-600 rounded text-sm text-white">
                                    <option value="">‚ñºÁóÖÂêçÈÅ∏Êäû</option>
                                    {majorDiseases.map(d=><option key={d} value={d}>{d}</option>)}
                                </select>
                            </div>
                            <TextArea value={data.pastIllness} onChange={v=>up('pastIllness',v)} rows="3" />
                            <Label>ÂÆ∂ÊóèÊßãÊàê</Label>
                            <TextArea value={data.familyStructure} onChange={v=>up('familyStructure',v)} rows="2" placeholder="ÂÆ∂ÊóèÊßãÊàê" />
                            <div className="grid grid-cols-2 gap-2 mt-2">
                                <div>
                                    <Label>ÊÑüÊüìÁóá</Label>
                                    <div className="flex gap-2">
                                        <select 
                                            value={data.infection} 
                                            onChange={e => up('infection', e.target.value)}
                                            className="bg-gray-900 border border-gray-600 rounded px-1 text-sm text-white focus:border-blue-500 w-16"
                                        >
                                            <option value="">Êú™</option>
                                            <option value="Êúâ">Êúâ</option>
                                            <option value="ÁÑ°">ÁÑ°</option>
                                        </select>
                                        <div className="flex-1 flex gap-1">
                                            <select 
                                                className="w-20 bg-gray-900 border border-gray-600 rounded px-1 text-sm text-white focus:border-blue-500"
                                                onChange={e => {
                                                    if(!e.target.value) return;
                                                    const current = data.infectionDetail || '';
                                                    const newVal = current ? current + '„ÄÅ' + e.target.value : e.target.value;
                                                    up('infectionDetail', newVal);
                                                    e.target.value = '';
                                                }}
                                            >
                                                <option value="">‚ñºÈÅ∏Êäû</option>
                                                {infectionList.map(i => <option key={i} value={i}>{i}</option>)}
                                            </select>
                                            <Input value={data.infectionDetail} onChange={v=>up('infectionDetail',v)} placeholder="Ë©≥Á¥∞" className="flex-1"/>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <Label>„Ç¢„É¨„É´„ÇÆ„Éº</Label>
                                    <div className="flex gap-2">
                                        <select 
                                            value={data.allergy} 
                                            onChange={e => up('allergy', e.target.value)}
                                            className="bg-gray-900 border border-gray-600 rounded px-1 text-sm text-white focus:border-blue-500"
                                        >
                                            <option value="">Êú™</option>
                                            <option value="Êúâ">Êúâ</option>
                                            <option value="ÁÑ°">ÁÑ°</option>
                                        </select>
                                        <Input value={data.allergyDetail} onChange={v=>up('allergyDetail',v)} placeholder="Ë©≥Á¥∞" className="flex-1"/>
                                    </div>
                                </div>
                            </div>
                        </InputGroup>

                        <InputGroup title="4. ‰∏ÄËà¨Áä∂ÊÖã„Éª„ÉØ„ÇØ„ÉÅ„É≥">
                             <div className="mb-2">
                                <Label>Ë∫´‰ΩìË®àÊ∏¨</Label>
                                <div className="grid grid-cols-3 gap-2">
                                    <Input value={data.height} onChange={v=>up('height',v)} placeholder="Ë∫´Èï∑cm" />
                                    <Input value={data.weight} onChange={v=>up('weight',v)} placeholder="‰ΩìÈáçkg" />
                                    <div className="relative bg-gray-700 rounded border border-gray-600">
                                        <input type="date" value={data.measureDate} onChange={e=>up('measureDate',e.target.value)} className="w-full bg-transparent text-white px-1 py-1 outline-none cursor-pointer text-xs" style={{colorScheme:"dark"}}/>
                                    </div>
                                </div>
                            </div>
                            <div className="grid grid-cols-4 gap-2 mb-2">
                                <div><Label>Ë°ÄÂúß(‰∏ä)</Label><Input value={data.bp_sys} onChange={v=>up('bp_sys',v)}/></div>
                                <div><Label>Ë°ÄÂúß(‰∏ã)</Label><Input value={data.bp_dia} onChange={v=>up('bp_dia',v)}/></div>
                                <div><Label>ËÑàÊãç</Label><Input value={data.pulse} onChange={v=>up('pulse',v)}/></div>
                                <div><Label>‰ΩìÊ∏©</Label><Input value={data.temp} onChange={v=>up('temp',v)}/></div>
                            </div>
                            <div className="mb-2"><Label>„Ç§„É≥„Éï„É´Êé•Á®ÆÊó•</Label><input type="date" value={data.vaccine_flu} onChange={e=>up('vaccine_flu',e.target.value)} className="w-full bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white" style={{colorScheme:"dark"}}/></div>
                            <div className="flex gap-2 mb-2">
                                <div className="w-2/3"><Label>„Ç≥„É≠„ÉäÊé•Á®ÆÊó•</Label><input type="date" value={data.vaccine_corona} onChange={e=>up('vaccine_corona',e.target.value)} className="w-full bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white" style={{colorScheme:"dark"}}/></div>
                                <div className="w-1/3"><Label>ÂõûÊï∞</Label><Input value={data.vaccine_corona_count} onChange={v=>up('vaccine_corona_count',v)}/></div>
                            </div>
                            <Label>ÂÖ•Èô¢„Åæ„Åß„ÅÆÁµåÈÅé</Label>
                            <TextArea value={data.historyInfo} onChange={v=>up('historyInfo',v)} rows="4" />
                        </InputGroup>

                        <InputGroup title="5. ADLË©≥Á¥∞">
                            <div className="mb-3">
                                <Label>ÁßªÂãï</Label>
                                <div className="flex flex-wrap gap-3 mb-2">
                                    <CheckBox label="Áã¨Ê≠©" checked={data.move_status.walk} onChange={v=>upDeep('move_status','walk',v)}/>
                                    <CheckBox label="Êùñ" checked={data.move_status.cane} onChange={v=>upDeep('move_status','cane',v)}/>
                                    <CheckBox label="ËÄÅ‰∫∫Ëªä" checked={data.move_status.car} onChange={v=>upDeep('move_status','car',v)}/>
                                    <CheckBox label="Ê≠©Ë°åÂô®" checked={data.move_status.walker} onChange={v=>upDeep('move_status','walker',v)}/>
                                    <CheckBox label="ËªäÊ§ÖÂ≠ê" checked={data.move_status.wheelchair} onChange={v=>upDeep('move_status','wheelchair',v)}/>
                                    <CheckBox label="„É™„ÇØ„É©„Ç§„Éã„É≥„Ç∞" checked={data.move_status.reclining} onChange={v=>upDeep('move_status','reclining',v)}/>
                                </div>
                                <TextArea value={data.move_note} onChange={v=>up('move_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å (‰æã: Ëá™ÊìçÂèØ)" rows="2" />
                            </div>
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>È£ü‰∫ã</Label>
                                <RadioGroup options={['Ëá™Á´ã','ÈÉ®ÂàÜ‰ªãÂä©','ÂÖ®‰ªãÂä©','Áµ∂È£ü']} value={data.food_level} onChange={v=>up('food_level',v)}/>
                                <div className="grid grid-cols-2 gap-2 mt-2">
                                    <div><Label>‰∏ªÈ£ü</Label><Select options={stapleFoodOptions} value={data.food_main} onChange={v=>up('food_main',v)}/></div>
                                    <div><Label>ÂâØÈ£ü</Label><Select options={sideDishOptions} value={data.food_side} onChange={v=>up('food_side',v)}/></div>
                                </div>
                                <div className="mt-1"><Label>„Éà„É≠„Éü</Label><Select options={toromiOptions} value={data.food_toromi} onChange={v=>up('food_toromi',v)}/></div>
                                <div className="mt-2"><TextArea value={data.food_note} onChange={v=>up('food_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å" rows="2" /></div>
                            </div>
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>ÊéíÊ≥Ñ</Label>
                                <RadioGroup options={['Ëá™Á´ã','ÈÉ®ÂàÜ‰ªãÂä©','ÂÖ®‰ªãÂä©']} value={data.exc_level} onChange={v=>up('exc_level',v)}/>
                                <div className="flex flex-wrap gap-2 mt-2">
                                    <CheckBox label="„Éà„Ç§„É¨" checked={data.exc_tool.toilet} onChange={v=>upDeep('exc_tool','toilet',v)}/>
                                    <CheckBox label="„Éù„Éº„Çø„Éñ„É´" checked={data.exc_tool.portable} onChange={v=>upDeep('exc_tool','portable',v)}/>
                                    <CheckBox label="„É™„Éè„Éë„É≥" checked={data.exc_tool.rehab_pants} onChange={v=>upDeep('exc_tool','rehab_pants',v)}/>
                                    <CheckBox label="„Ç™„É†„ÉÑ" checked={data.exc_tool.diaper} onChange={v=>upDeep('exc_tool','diaper',v)}/>
                                </div>
                                <div className="grid grid-cols-2 gap-2 mt-2">
                                    <div><Label>ÊéíÂ∞ø(Âõû/Êó•)</Label><Input value={data.exc_urine_freq} onChange={v=>up('exc_urine_freq',v)}/></div>
                                    <div><Label>Êéí‰æø(Âõû/Êó•)</Label><Input value={data.exc_stool_freq} onChange={v=>up('exc_stool_freq',v)}/></div>
                                </div>
                                <div className="flex gap-2 mt-2 items-center">
                                    <Label>ÊúÄÁµÇÊéí‰æø</Label>
                                    <Input value={data.exc_last_stool_month} onChange={v=>up('exc_last_stool_month',v)} className="w-10 text-center"/>Êúà
                                    <Input value={data.exc_last_stool_day} onChange={v=>up('exc_last_stool_day',v)} className="w-10 text-center"/>Êó•
                                </div>
                                <div className="flex gap-4 mt-2">
                                    <div><Label>Â∞øÊÑè</Label><RadioGroup options={['Êúâ','ÁÑ°']} value={data.exc_urine_sense} onChange={v=>up('exc_urine_sense',v)}/></div>
                                    <div><Label>‰æøÊÑè</Label><RadioGroup options={['Êúâ','ÁÑ°']} value={data.exc_stool_sense} onChange={v=>up('exc_stool_sense',v)}/></div>
                                </div>
                                <div className="mt-2 flex gap-2">
                                    <Label>‰∏ãÂâ§</Label>
                                    <RadioGroup options={['Êúâ','ÁÑ°']} value={data.exc_laxative} onChange={v=>up('exc_laxative',v)}/>
                                    <Input value={data.exc_laxative_detail} onChange={v=>up('exc_laxative_detail',v)} placeholder="Ëñ¨Ââ§Âêç"/>
                                </div>
                                <div className="mt-2"><TextArea value={data.exc_note} onChange={v=>up('exc_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å" rows="2" /></div>
                            </div>
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>ÂÖ•Êµ¥</Label>
                                <RadioGroup options={['Ëá™Á´ã','ÈÉ®ÂàÜ‰ªãÂä©','ÂÖ®‰ªãÂä©']} value={data.bath_level} onChange={v=>up('bath_level',v)}/>
                                <div className="flex gap-4 mt-2">
                                    <div><Label>ÂõûÊï∞/ÈÄ±</Label><Input value={data.bath_freq} onChange={v=>up('bath_freq',v)} className="w-16"/></div>
                                    <div><Label>ÊñπÊ≥ï</Label><RadioGroup options={['ÂÄãÊµ¥','ÁâπÊµ¥']} value={data.bath_method} onChange={v=>up('bath_method',v)}/></div>
                                </div>
                                <div className="flex gap-2 mt-2 items-center">
                                    <Label>ÊúÄÁµÇÂÖ•Êµ¥</Label>
                                    <Input value={data.bath_last_month} onChange={v=>up('bath_last_month',v)} className="w-10 text-center"/>Êúà
                                    <Input value={data.bath_last_day} onChange={v=>up('bath_last_day',v)} className="w-10 text-center"/>Êó•
                                </div>
                                <div className="mt-2"><TextArea value={data.bath_note} onChange={v=>up('bath_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å" rows="2" /></div>
                            </div>
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>Êõ¥Ë°£</Label>
                                <RadioGroup options={['Ëá™Á´ã','ÈÉ®ÂàÜ‰ªãÂä©','ÂÖ®‰ªãÂä©']} value={data.cloth_level} onChange={v=>up('cloth_level',v)}/>
                                <div className="mt-2"><TextArea value={data.cloth_note} onChange={v=>up('cloth_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å" rows="2" /></div>
                            </div>
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>Áù°Áú†</Label>
                                <RadioGroup options={['ËâØÂ•Ω','ÊôÇ„ÄÖ‰∏çÁú†','‰∏çÁú†']} value={data.sleep_status} onChange={v=>up('sleep_status',v)}/>
                                <div className="flex gap-2 mt-2">
                                    <Label>Áú†Ââ§</Label>
                                    <RadioGroup options={['Êúâ','ÁÑ°']} value={data.sleep_drug} onChange={v=>up('sleep_drug',v)}/>
                                    <Input value={data.sleep_drug_detail} onChange={v=>up('sleep_drug_detail',v)} placeholder="Ëñ¨Ââ§Âêç"/>
                                </div>
                                <div className="mt-2"><TextArea value={data.sleep_note} onChange={v=>up('sleep_note',v)} placeholder="ÂÖ∑‰ΩìÁöÑÁä∂Ê≥Å" rows="2" /></div>
                            </div>
                          
                            <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>ÈöúÂÆ≥„ÉªÊÑüË¶ö„ÉªÁâ©ÂìÅ</Label>
                                <div className="flex flex-wrap gap-3 mb-2">
                                    <CheckBox label="Ë¶ñË¶ö" checked={data.disability.sight} onChange={v=>upDeep('disability','sight',v)}/>
                                    <CheckBox label="ËÅ¥Ë¶ö" checked={data.disability.hearing} onChange={v=>upDeep('disability','hearing',v)}/>
                                    <CheckBox label="Ë®ÄË™û" checked={data.disability.speech} onChange={v=>upDeep('disability','speech',v)}/>
                                    <CheckBox label="Ë™çÁü•" checked={data.disability.cognitive} onChange={v=>upDeep('disability','cognitive',v)}/>
                                    <CheckBox label="ÈÅãÂãï" checked={data.disability.motor} onChange={v=>upDeep('disability','motor',v)}/>
                                    <CheckBox label="„Åù„ÅÆ‰ªñ" checked={data.disability.other} onChange={v=>upDeep('disability','other',v)}/>
                                </div>
                                <div className="mb-2"><Label>ÊÑèÊÄùÁñéÈÄö</Label><RadioGroup options={['ÂèØ','‰∏ÄÈÉ®','‰∏çÂèØ']} value={data.communication} onChange={v=>up('communication',v)}/></div>
                                <div className="grid grid-cols-2 gap-2">
                                    <div><Label>„É°„Ç¨„Éç</Label><RadioGroup options={['Êúâ','ÁÑ°']} value={data.glasses} onChange={v=>up('glasses',v)}/></div>
                                    <div><Label>Ë£úËÅ¥Âô®</Label><RadioGroup options={['Êúâ','ÁÑ°']} value={data.hearing_aid} onChange={v=>up('hearing_aid',v)}/></div>
                                    <div><Label>Áæ©Ê≠Ø</Label><RadioGroup options={['Êúâ','ÁÑ°']} value={data.denture} onChange={v=>up('denture',v)}/>
                                    <Input value={data.denture_detail} onChange={v=>up('denture_detail',v)} placeholder="Ë©≥Á¥∞"/></div>
                                </div>
                                <div className="mb-3 border-t border-gray-600 pt-2">
                                <Label>Âá¶ÁΩÆÂÜÖÂÆπ</Label>
                                <TextArea value={data.treatment_detail} onChange={v=>up('treatment_detail',v)} rows="2" />
                                </div>
                            </div>
                        </InputGroup>
                        
                        <InputGroup title="6. „Åù„ÅÆ‰ªñ">
                            
                            <Label>ÁâπË®ò‰∫ãÈ†Ö</Label>
                            <TextArea value={data.specialNote} onChange={v=>up('specialNote',v)} rows="3" />
                            <Label>ÊñΩË®≠Âêç</Label><TextArea value={data.facilityName} onChange={v=>up('facilityName',v)} rows="2" />
                            <Label>ÊãÖÂΩìËÄÖÂêç</Label><Input value={data.staffName} onChange={v=>up('staffName',v)}/>
                        </InputGroup>
                    </div>

                    {/* Âè≥ÂÅ¥Ôºö„Éó„É¨„Éì„É•„Éº (A4Âç∞Âà∑Áî®) */}
                    <div className="w-full md:w-2/3 bg-gray-500 p-4 overflow-y-auto h-screen flex justify-center">
                        <div id="print-area" className="sheet">
                            
                            {/* „Éò„ÉÉ„ÉÄ„Éº */}
                            <div className="relative border-b-2 border-black mb-1 pb-1 h-10 flex items-end justify-center">
                                <h1 className="text-2xl font-bold">ÁúãË≠∑„Çµ„Éû„É™„Éº</h1>
                                <div className="absolute right-0 bottom-1 text-sm">
                                    ‰ΩúÊàêÊó•Ôºö{toWareki(data.admissionDate)}
                                </div>
                            </div>

                            {/* Âü∫Êú¨ÊÉÖÂ†±„Ç®„É™„Ç¢ */}
                            <table className="excel mb-1 mt-2">
                                {/* ÂàóÂÆöÁæ©Ôºà8ÂàóÔºâ */}
                                <colgroup>
                                    <col style={{width:'70px'}}/><col style={{width:'14%'}}/>
                                    <col style={{width:'30px'}}/><col style={{width:'40px'}}/>
                                    <col style={{width:'60px'}}/><col style={{width:'auto'}}/>
                                    <col style={{width:'80px'}}/><col style={{width:'14%'}}/>
                                </colgroup>
                                <tbody>
                                    {/* 1Ë°åÁõÆ */}
                                    <tr>
                                        <th>„Éï„É™„Ç¨„Éä</th>
                                        <td colSpan="2" className="border-r-0 p-0 overflow-visible">
                                            <div className="w-full px-1 whitespace-nowrap font">
                                                {data.kana}
                                            </div>
                                        </td>
                                        <td className="border-l-0"></td>
                                        <th>‰ΩèÊâÄ</th>
                                        <td className="text-xs p-1">{data.address}</td>
                                        <th>ÂÖ•ÊâÄÊó•</th>
                                        <td className="text-center text-xs whitespace-nowrap tracking-tighter px-0 font">{toWareki(data.createdDate)}</td>
                                    </tr>
                                    {/* 2Ë°åÁõÆ */}
                                    <tr>
                                        <th>Ê∞èÂêç</th>
                                        <td colSpan="2" className="p-1 font whitespace-nowrap overflow-visible border-r">
                                            <div className="w-full flex justify-between items-center px-1">
                                                <div className="flex items-center gap-1">
                                                    <span className="text-base tracking-tighter">{data.name}</span>
                                                    <span className="text-sm font-normal">Êßò</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td className="text-center p-0 border-l border-r whitespace-nowrap">
                                            {data.gender}
                                        </td>
                                        <th>TEL</th>
                                        <td className="text-center text-xs whitespace-nowrap">{data.tel}</td>
                                        <th>‰∏ªÊ≤ªÂåª</th>
                                        <td className="text-center text-xs whitespace-nowrap">{data.doctor}</td>
                                    </tr>
                                    {/* 3Ë°åÁõÆ */}
                                    <tr>
                                        <th>ÁîüÂπ¥ÊúàÊó•</th>
                                        <td colSpan="2" className="text-center p-0 border-r-0 overflow-visible">
                                            <div className="w-full px-1 whitespace-nowrap text-[12px] tracking-tighter font">
                                                {data.birthEra}{data.birthYear}Âπ¥{data.birthMonth}Êúà{data.birthDay}Êó•
                                            </div>
                                        </td>
                                        <td className="text-center p-0  border-l border-r whitespace-nowrap">
                                            <span className="text-xs font">{data.age}Ê≠≥</span>
                                        </td>
                                        <td colSpan="4" className="p-0">
                                            <div className="flex h-full items-center">
                                                <div className="w-[100px] border-r border-black h-full flex items-center justify-center bg-gray-100 ">‰ªãË≠∑Â∫¶</div>
                                                <div className="w-[100px] border-r border-black h-full flex items-center justify-center text-sm ">{data.careLevel}</div>
                                                <div className="w-[80px] border-r border-black h-full flex items-center justify-center bg-gray-100 text-xs ">„Ç±„Ç¢„Éû„Éç</div>
                                                <div className="flex-1 h-full flex items-center justify-center text-sm">{data.careManager}</div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            {/* „Ç≠„Éº„Éë„Éº„ÇΩ„É≥„Ç®„É™„Ç¢ */}
                            <table className="excel mb-1">
                                <colgroup>
                                    <col style={{width:'12%'}}/><col/>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <th rowSpan="2">„Ç≠„Éº„Éë„Éº„ÇΩ„É≥</th>
                                        <td className="p-0 align-top">
                                            <div className="flex h-full">
                                                <div className="w-1/2 border-r border-black">
                                                    <div className="border-b border-dotted border-black p-1 text-xs bg-gray-50">
                                                        <span className="border border-black px-1">Á∑äÊÄ•ÊôÇÈÄ£Áµ°ÂÖà‚ë†</span>
                                                    </div>
                                                    <div className="flex">
                                                        <div className="w-3/4 border-r border-black p-1 text-sm">
                                                            <div>{data.kp1_name}</div>
                                                            <div className="text-xs">TEL: {data.kp1_tel}</div>
                                                        </div>
                                                        <div className="w-1/4 p-1 text-xs flex items-center justify-center">Á∂öÊüÑ:<br/>{data.kp1_rel}</div>
                                                    </div>
                                                </div>
                                                <div className="w-1/2">
                                                    <div className="border-b border-dotted border-black p-1 text-xs bg-gray-50">
                                                        <span className="border border-black px-1">Á∑äÊÄ•ÊôÇÈÄ£Áµ°ÂÖà‚ë°</span>
                                                    </div>
                                                    <div className="flex">
                                                        <div className="w-3/4 border-r border-black p-1 text-sm">
                                                            <div>{data.kp2_name}</div>
                                                            <div className="text-xs">TEL: {data.kp2_tel}</div>
                                                        </div>
                                                        <div className="w-1/4 p-1 text-xs flex items-center justify-center">Á∂öÊüÑ:<br/>{data.kp2_rel}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            {/* Êó¢ÂæÄÊ≠¥„ÉªÂÆ∂ÊóèÊßãÊàê„ÉªÊÑüÊüìÁóá„Éª„Ç¢„É¨„É´„ÇÆ„Éº„Ç®„É™„Ç¢ */}
                            <table className="excel mb-1">
                                <colgroup>
                                    <col style={{width:'12%'}}/><col style={{width:'38%'}}/>
                                    <col style={{width:'12%'}}/><col style={{width:'38%'}}/>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <th style={{height:'70px'}}>Êó¢ÂæÄÊ≠¥</th>
                                        <td className="align-top" style={{whiteSpace:'pre-wrap'}}>{data.pastIllness}</td>
                                        <th>ÂÆ∂ÊóèÊßãÊàê</th>
                                        <td className="align-top" style={{whiteSpace:'pre-wrap'}}>{data.familyStructure}</td>
                                    </tr>
                                </tbody>
                            </table>
                            {/* ÊÑüÊüìÁóá„Éª„Ç¢„É¨„É´„ÇÆ„ÉºË°å */}
                            <table className="excel mb-1">
                                <colgroup>
                                    <col style={{width:'12%'}}/><col style={{width:'38%'}}/>
                                    <col style={{width:'12%'}}/><col style={{width:'38%'}}/>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <th>ÊÑüÊüìÁóá</th>
                                        <td>{data.infection === 'Êúâ' ? (data.infectionDetail && data.infectionDetail.trim() !== '' ? `Êúâ (${data.infectionDetail})` : 'Êúâ') : 'ÁÑ°'}</td>
                                        <th className="bg-gray-200 border-l border-black">„Ç¢„É¨„É´„ÇÆ„Éº</th>
                                        <td>{data.allergy === 'Êúâ' ? (data.allergyDetail && data.allergyDetail.trim() !== '' ? `Êúâ (${data.allergyDetail})` : 'Êúâ') : 'ÁÑ°'}</td>
                                    </tr>
                                </tbody>
                            </table>

                            {/* ‰∏ÄËà¨Áä∂ÊÖã */}
                            <div className="text-center font-bold text-sm border-b border-black mb-1">&lt;ÂÖ•ÊâÄÊúüÈñì‰∏≠„ÅÆ‰∏ÄËà¨Áä∂ÊÖã&gt;</div>
                            <table className="excel mb-1 border-none">
                                <tbody>
                                    <tr className="border-none">
                                        <td className="border-none p-0">
                                            <div className="border border-black p-1 mb-1 text-center font-normal">
                                                <span>Ë∫´Èï∑Ôºö{data.height} cm / ‰ΩìÈáçÔºö{data.weight} kg</span>
                                                {data.measureDate && (
                                                    <span className="text-sm text-black">
                                                        Ôºà{toWareki(data.measureDate)}ÁèæÂú®Ôºâ
                                                    </span>
                                                )}
                                            </div>
                                            <div className="border border-black p-1 flex justify-around ">
                                                <span>Ë°ÄÂúßÔºö {data.bp_sys} / {data.bp_dia}</span>
                                                <span>ËÑàÊãçÔºö {data.pulse}</span>
                                                <span>‰ΩìÊ∏©Ôºö {data.temp}</span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr className="border-none">
                                        <td className="border-none p-0 pt-1">
                                            <div className="border border-black p-1 text-center">
                                                „ÉØ„ÇØ„ÉÅ„É≥Êé•Á®ÆÔºö „Ç§„É≥„Éï„É´„Ç®„É≥„Ç∂ ({data.vaccine_flu ? toWareki(data.vaccine_flu) : '„Éº'})„ÄÄÔºö„ÄÄ
                                                „Ç≥„É≠„Éä ({data.vaccine_corona ? toWareki(data.vaccine_corona) : '„Éº'} {data.vaccine_corona_count ? data.vaccine_corona_count+'ÂõûÁõÆ':''})
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div className="text-sm font-bold border-b border-black mb-1">&lt;ÂÖ•Èô¢„Åæ„Åß„ÅÆÁµåÈÅé&gt;</div>
                            <div className="border border-black p-2 min-h-[70px] text-sm mb-1" style={{whiteSpace:'pre-wrap'}}>
                                {data.historyInfo}
                            </div>

                            {/* ADLË°®Ôºà„ÉÅ„Çß„ÉÉ„ÇØÊ∏à„Åø„ÅÆ„ÅøË°®Á§∫Ôºâ */}
                            <table className="excel flex-grow">
                                <colgroup>
                                    <col style={{width:'12%'}}/><col style={{width:'30%'}}/><col/>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>È†ÖÁõÆ</th>
                                        <th>ADLÁä∂Ê≥Å</th>
                                        <th>Ë©≥Á¥∞„ÉªÁïôÊÑè‰∫ãÈ†Ö</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>ÁßªÂãï</th>
                                        <td>{getCheckedItems(data.move_status, moveLabels)}</td>
                                        <td style={{whiteSpace:'pre-wrap'}}>{data.move_note}</td>
                                    </tr>
                                    <tr>
                                        <th>È£ü‰∫ã</th>
                                        <td>{data.food_level}</td>
                                        <td className="text-xs p-1">
                                            <div>‰∏ªÈ£ü: {data.food_main} / ÂâØÈ£ü: {data.food_side}</div>
                                            <div>„Å®„Çç„Åø: {data.food_toromi}</div>
                                            <div style={{whiteSpace:'pre-wrap'}}>{data.food_note}</div>
                                        </td>
                                    </tr>
                                     <tr>
                                      <th className="bg-gray-100 border-r border-black p-1 text-sm font-normal align-middle">
                                        ÊéíÊ≥Ñ
                                      </th>
                                      
                                      <td className="border-r border-black p-1 align-top leading-tight">
                                        <div className="border-b border-dotted border-black mb-0.5 pb-0.5 text-sm">
                                          {data.exc_level}
                                        </div>
                                        <div className="text-[11px]">
                                          ÊéíÂ∞ø: {data.exc_urine_freq}Âõû/Êó•<br/>
                                          Êéí‰æø: {data.exc_stool_freq}
                                        </div>
                                      </td>

                                      {/* relative„ÇíÊåáÂÆö„Åó„ÄÅÈ´ò„Åï„Çí‰∏≠Ë∫´Ôºà„ÉÜ„Ç≠„Çπ„ÉàÔºâ„Å´Âêà„Çè„Åõ„Çã */}
                                      <td className="p-1 align-top text-[11px] leading-tight relative min-h-[3em]">
                                        <div>
                                          <div>Áî®ÂÖ∑: {getCheckedItems(data.exc_tool, excLabels)}</div>
                                          <div className="flex gap-2">
                                            <span>Â∞øÊÑè: {data.exc_urine_sense}</span>
                                            <span>‰æøÊÑè: {data.exc_stool_sense}</span>
                                          </div>
                                          <div>‰∏ãÂâ§: {data.exc_laxative === 'Êúâ' ? `Êúâ (${data.exc_laxative_detail})` : 'ÁÑ°'}</div>
                                          <div style={{ whiteSpace: 'pre-wrap' }}>{data.exc_note}</div>
                                        </div>
                                        
                                        {/* absolute„ÅßÂè≥‰∏ã„Å´Âõ∫ÂÆö„ÄÇ„Åì„Çå„Åß„Åì„ÅÆË°åËá™‰Ωì„ÅØÈ´ò„Åï„ÇíÂèñ„Çâ„Å™„Åè„Å™„Çä„Åæ„Åô */}
                                        <div className="absolute bottom-2 right-1 text-[12px]">
                                          ÊúÄÁµÇÊéí‰æø: {data.exc_last_stool_month}/{data.exc_last_stool_day}
                                        </div>
                                      </td>
                                    </tr>
                                    <tr>
                                        <th>ÂÖ•Êµ¥</th>
                                        <td className="p-1">
                                            <div className=" border-b border-dotted border-black mb-1">{data.bath_level}</div>
                                            <div className="text-xs">{data.bath_freq}Âõû/ÈÄ±</div>
                                        </td>
                                        <td className="text-xs p-1">
                                            <div>ÊñπÊ≥ï: {data.bath_method}</div>
                                            <div style={{whiteSpace:'pre-wrap'}}>{data.bath_note}</div>
                                            <div className="text-right mt-1 ">ÊúÄÁµÇÂÖ•Êµ¥: {data.bath_last_month}/{data.bath_last_day}</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Êõ¥Ë°£</th>
                                        <td>{data.cloth_level}</td>
                                        <td style={{whiteSpace:'pre-wrap'}}>{data.cloth_note}</td>
                                    </tr>
                                    <tr>
                                        <th>Áù°Áú†</th>
                                        <td>{data.sleep_status}</td>
                                        <td className="text-xs">
                                            <div>Áú†Ââ§: {data.sleep_drug === 'Êúâ' ? `Êúâ (${data.sleep_drug_detail})` : 'ÁÑ°'}</div>
                                            <div style={{whiteSpace:'pre-wrap'}}>{data.sleep_note}</div>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <th>ÈöúÂÆ≥</th>
                                        <td className="text-xs">{getCheckedItems(data.disability, disLabels)}</td>
                                        <td className="text-xs">ÊÑèÊÄùÁñéÈÄö: {data.communication}</td>
                                    </tr>
                                    
                                    <tr>
                                        <th>Ë∫´‰ΩìË£úÂä©ÂÖ∑</th>
                                        <td colSpan="2" className="text-xs p-1">
                                            <span className="mr-4 font">„É°„Ç¨„Éç: {data.glasses}</span>
                                            <span className="mr-4 font">Ë£úËÅ¥Âô®: {data.hearing_aid}</span>
                                            <span className="font">Áæ©Ê≠Ø: {data.denture === 'Êúâ' ? `Êúâ (${data.denture_detail})` : 'ÁÑ°'}</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Âá¶ÁΩÆ</th>
                                        <td colSpan="2" className="text-xs" style={{whiteSpace:'pre-wrap'}}>{data.treatment_detail}</td>
                                    </tr>
                                </tbody>
                            </table>

                            <div className="flex border border-black mt-auto no-break-inside">
                                <div className="w-2/3 border-r border-black p-1 min-h-[80px] text-xs">
                                    <strong>ÁâπË®ò‰∫ãÈ†Ö</strong><br/>
                                    <div style={{whiteSpace:'pre-wrap'}}>{data.specialNote}</div>
                                </div>
                                <div className="w-1/3 p-2 text-sm flex flex-col justify-between text-center">
                                    <div className="whitespace-pre-wrap font-bold text-center mb-2">{data.facilityName}</div>
                                    <div className="text-right">
                                        <span className="mr-2 text-xs">„Çµ„Éû„É™„ÉºÊãÖÂΩìËÄÖ</span>
                                        <span className="border-b border-black inline-block w-24 text-center mr-2">{data.staffName}</span>
                                        <span className="border border-black rounded-full w-4 h-4 inline-flex items-center justify-center text-[10px] align-middle">Âç∞</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
